# Issue Dependency Graph

> Last updated: 2025-12-24
> Auto-generated by `/update-dependency-graph`

## Android v1.0 Critical Path

```mermaid
flowchart TD
    subgraph INIT["Launch Android App #62"]
        direction TB
        E55["#55 Blocking Apps<br/>~85%"]
        E54["#54 User Auth<br/>~31%"]
        E57["#57 Strict Mode<br/>~30%"]
        E60["#60 Polish Design<br/>0%"]
    end

    E55 --> INIT
    E54 --> INIT
    E57 --> INIT
    E60 --> INIT

    style INIT fill:#f9f,stroke:#333,stroke-width:2px
    style E55 fill:#90EE90
    style E54 fill:#FFD700
    style E57 fill:#FFD700
    style E60 fill:#FF6B6B
```

## Native Blocking Architecture

The critical fix for #170 (blocking overlay never triggers).

```mermaid
flowchart TD
    subgraph NATIVE["Native-to-Native Blocking #170"]
        I171["#171<br/>Multiple listeners<br/>expo-accessibility-service"]
        I172["#172<br/>Callback system<br/>expo-foreground-service"]
        I173["#173<br/>BlockingCallback<br/>tied-siren-blocking-overlay"]
    end

    I171 --> I173
    I172 --> I173

    style I171 fill:#87CEEB
    style I172 fill:#87CEEB
    style I173 fill:#FFD700
```

## JS Architecture Refactoring

Sequential dependency chain for clean architecture.

```mermaid
flowchart TD
    subgraph PORTS["Port Definitions"]
        I177["#177<br/>SirenTier port"]
        I178["#178<br/>SirenLookout port"]
        I179["#179<br/>selectBlockingSchedule"]
    end

    subgraph IMPL["Implementations"]
        I181["#181<br/>Noop tiers (Kotlin)"]
        I182["#182<br/>AndroidSirenTier"]
        I180["#180<br/>Unified listener"]
    end

    subgraph WIRE["Wiring"]
        I183["#183<br/>Update DI"]
    end

    subgraph CLEANUP["Cleanup"]
        I184["#184<br/>Deprecate JS path"]
        I185["#185<br/>Remove legacy code"]
    end

    %% Port dependencies
    I177 --> I181
    I178 --> I181
    I177 --> I182
    I181 --> I182

    %% Listener needs ports + selector
    I177 --> I180
    I178 --> I180
    I179 --> I180

    %% DI needs implementations
    I177 --> I183
    I178 --> I183
    I182 --> I183

    %% Deprecation needs everything working
    I173 --> I184
    I180 --> I184
    I182 --> I184
    I183 --> I184

    %% Cleanup is last
    I184 --> I185

    style I177 fill:#87CEEB
    style I178 fill:#87CEEB
    style I179 fill:#87CEEB
    style I181 fill:#FFD700
    style I182 fill:#FFD700
    style I180 fill:#FFD700
    style I183 fill:#FFA500
    style I184 fill:#FF6B6B
    style I185 fill:#FF6B6B
```

## Full Blocking Pipeline

Combined native + JS architecture.

```mermaid
flowchart LR
    subgraph PARALLEL["Can Start Now"]
        I171["#171 Multiple listeners"]
        I172["#172 Callback system"]
        I177["#177 SirenTier port"]
        I178["#178 SirenLookout port"]
        I179["#179 Selector"]
    end

    subgraph PHASE2["Phase 2"]
        I173["#173 BlockingCallback"]
        I181["#181 Noop tiers"]
        I180["#180 Unified listener"]
    end

    subgraph PHASE3["Phase 3"]
        I182["#182 AndroidSirenTier"]
        I183["#183 Update DI"]
    end

    subgraph PHASE4["Phase 4 - Cleanup"]
        I184["#184 Deprecate JS path"]
        I185["#185 Remove legacy"]
    end

    I171 --> I173
    I172 --> I173
    I177 --> I181
    I178 --> I181
    I177 --> I180
    I178 --> I180
    I179 --> I180

    I181 --> I182
    I177 --> I182
    I173 --> I184
    I180 --> I184
    I182 --> I183
    I183 --> I184

    I184 --> I185

    style PARALLEL fill:#90EE90,stroke:#333
    style PHASE2 fill:#FFD700,stroke:#333
    style PHASE3 fill:#FFA500,stroke:#333
    style PHASE4 fill:#FF6B6B,stroke:#333
```

## Authentication Track

Independent from blocking work.

```mermaid
flowchart TD
    subgraph DONE["Completed"]
        I85["#85 Firebase setup"]
        I86["#86 Email/password"]
        I87["#87 Google Sign-In"]
    end

    subgraph INPROG["In Progress"]
        I89["#89 Error handling"]
    end

    subgraph TODO["Todo"]
        I88["#88 Apple Sign-In"]
        I164["#164 Re-authentication"]
        I161["#161 Email verification"]
        I167["#167 Brute force"]
    end

    subgraph DEPENDS["Has Dependencies"]
        I162["#162 Change password"]
        I163["#163 Account deletion"]
        I160["#160 Custom reset"]
        I165["#165 Resend reset"]
    end

    I85 --> I86
    I85 --> I87
    I85 --> I88

    I164 --> I162
    I164 --> I163
    I160 --> I165

    style DONE fill:#90EE90
    style INPROG fill:#FFD700
    style TODO fill:#87CEEB
    style DEPENDS fill:#DDA0DD
```

## Work Streams Summary

| Stream | Can Start Now | Blocked By |
|--------|---------------|------------|
| **Native blocking** | #171, #172 | — |
| **JS ports** | #177, #178, #179 | — |
| **Native glue** | — | #171, #172 |
| **JS implementations** | — | Ports (#177, #178) |
| **Cleanup** | — | Everything else |
| **Auth** | #88, #89, #161, #164, #167 | — |

## Recommended Execution Order

### Week 1: Foundations (Parallel)
- [ ] #171 - Multiple listeners (native)
- [ ] #172 - Callback system (native)
- [ ] #177 - SirenTier port (JS)
- [ ] #178 - SirenLookout port (JS)
- [ ] #179 - selectBlockingSchedule (JS)

### Week 2: Implementations (Parallel after deps)
- [ ] #173 - BlockingCallback (needs #171, #172)
- [ ] #181 - Noop tiers in Kotlin (needs #177, #178)
- [ ] #180 - Unified listener (needs #177, #178, #179)

### Week 3: Wiring
- [ ] #182 - AndroidSirenTier (needs #177, #181)
- [ ] #183 - Update DI (needs #177, #178, #182)

### Week 4: Cleanup
- [ ] #184 - Deprecate JS path (needs #173, #180, #182, #183)
- [ ] #185 - Remove legacy code (needs #184)

---

## Legend

| Color | Meaning |
|-------|---------|
| Green | Ready to start / Completed |
| Blue | Can start (no blockers) |
| Yellow | In progress / Has some deps |
| Orange | Multiple dependencies |
| Red | Blocked / Final cleanup |
| Purple | Has dependencies |

---

## Raw Dependency Data

```yaml
# Native Blocking
171: []                          # Independent
172: []                          # Independent
173: [171, 172]                  # Needs both native modules

# JS Architecture
177: []                          # Independent
178: []                          # Independent
179: []                          # Independent
180: [177, 178, 179]             # Needs all ports
181: [177, 178]                  # Needs port definitions
182: [177, 181]                  # Needs tier port + noop impls
183: [177, 178, 182]             # Needs ports + AndroidSirenTier
184: [173, 180, 182, 183]        # Needs everything working
185: [184]                       # Must be last

# Auth (independent track)
88: [85]                         # Done
89: []                           # In progress
160: []                          # Independent
161: []                          # Independent
162: [164]                       # Needs re-auth
163: [164]                       # Needs re-auth
164: []                          # Independent
165: [160]                       # Needs custom reset first
166: []                          # Independent
167: []                          # Independent
168: []                          # Independent
169: []                          # Independent
```
